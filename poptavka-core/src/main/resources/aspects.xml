<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd">

    <aop:config>
        <!-- pointcuts -->
        <aop:pointcut id="allProjectClasses" expression="execution(* cz.poptavka.sample..*.*(..))" />
        <aop:pointcut id="jobs" expression="execution(* cz.poptavka.sample.service.jobs..JobTask+.execute())" />

        <!-- aspects -->
        <aop:aspect id="exceptionLoggerAspect" ref="exceptionLogger">
            <aop:after-throwing  throwing="exception"  pointcut-ref="allProjectClasses" method="logExceptionMethod" />
        </aop:aspect>
        <!-- Log execution of jobs -->
        <aop:aspect id="executionTimeLoggerAspect" ref="executionTimeLogger">
            <aop:around pointcut-ref="jobs" method="logTimeMethod" />
        </aop:aspect>

    </aop:config>

    <!-- aspects' beans' -->
    <bean id="exceptionLogger" class="cz.poptavka.sample.application.logging.ExceptionLogger">
        <property name="recipients">
            <!-- Write down mail addresses where the notification email will be sent when an exception occurs -->
            <list>
                <value>jumarko@gmail.com</value>
            </list>
        </property>
        <property name="mailService" ref="mailService" />
    </bean>

    <bean id="executionTimeLogger" class="cz.poptavka.sample.application.logging.ExecutionTimeLogger" />


</beans>
